
/*use master
go
if exists(select * from sys.databases
where name='ESCUELA')
drop database ESCUELA
go
*/

CREATE DATABASE ESCUELA
USE ESCUELA

----TABLA CARRERA
CREATE TABLE CARRERA(
CLAVE_C INT,
NOMB_C VARCHAR(50),
DURAC_C FLOAT,
CONSTRAINT PK_CC PRIMARY KEY(CLAVE_C)
)

INSERT INTO CARRERA VALUES(1,'INGINIERO EN SISTEMAS',5)
INSERT INTO CARRERA VALUES(2,'ADMINISTRADOR DE EMPRESAS',3)
INSERT INTO CARRERA VALUES(3,'CONTABILIDAD',4)
INSERT INTO CARRERA VALUES(4,'DISEÑO',3)


SELECT * FROM CARRERA


-- CREATE MATERIA
CREATE TABLE MATERIA(
CLAVE_M INT,
NOM_M VARCHAR (50),
CRED_M FLOAT,
CONSTRAINT PK_CM PRIMARY KEY(CLAVE_M)
)
INSERT INTO MATERIA VALUES(1,'MATEMATICA',25)
INSERT INTO MATERIA VALUES(2,'FISICA',15)
INSERT INTO MATERIA VALUES(3,'QUIMICA',24)
INSERT INTO MATERIA VALUES(4,'REDAXION',16)
INSERT INTO MATERIA VALUES(5,'INGLES',21)
INSERT INTO MATERIA VALUES(6,'CONTABILIDAD',12)
INSERT INTO MATERIA VALUES(7,'DIBUJO',17)
INSERT INTO MATERIA VALUES(8,'PROGRAMACION',20)

SELECT * FROM MATERIA

--CREATE PROFESOR
CREATE TABLE PROFESOR(
CLAVE_P INT,
NOM_P VARCHAR (150),
DIRE_P VARCHAR (200),
TELEF_P BIGINT,
HORA_P DATETIME,
CONSTRAINT PK_CP PRIMARY KEY(CLAVE_P)
)
INSERT INTO PROFESOR VALUES(1,'DANIEL DEISON','CALLE CHADIN',987654328,'8:00')
INSERT INTO PROFESOR VALUES(2,'MARIANO RODRIGUEZ','CALLE ROSA',987646328,'9:00')
INSERT INTO PROFESOR VALUES(3,'LACTAYO VASQUEZ','CALLE AZUL',787654328,'10:00')
INSERT INTO PROFESOR VALUES(4,'JUAN AGUILAR','CALLE IGLESIA',986654329,'8:30')

SELECT * FROM PROFESOR 


/*TABLA ALUMNO
(CON UNA CABLE FORANEA) */
CREATE TABLE ALUMNO(
MAT_ALU INT,
NOM_ALU VARCHAR(50),
EDAD_ALU INT,
SEM_ALU INT,
GENERO_ALU VARCHAR(10),
CLAVE_C1 INT,
CONSTRAINT PK_CALU PRIMARY KEY(MAT_ALU),
CONSTRAINT FK_FC1 FOREIGN KEY(CLAVE_C1) REFERENCES CARRERA(CLAVE_C)
)
INSERT INTO ALUMNO VALUES(1,'ALEX',26,6,'HOMBRE',1)
INSERT INTO ALUMNO VALUES(2,'SERGIO',19,7,'HOMBRE',2)
INSERT INTO ALUMNO VALUES(3,'JULIETA',20,8,'MUJER',3)

SELECT * FROM ALUMNO 

--ALUMNO -- PROFESOR
CREATE TABLE ALU_PROF(
MAT_ALU1 INT,
CLAVE_P1 INT,
CONSTRAINT FK_FALU1 FOREIGN KEY (MAT_ALU1)REFERENCES ALUMNO(MAT_ALU),
CONSTRAINT FK_FP1 FOREIGN KEY(CLAVE_P1)REFERENCES PROFESOR(CLAVE_P)
)
INSERT INTO ALU_PROF VALUES(1,3)
INSERT INTO ALU_PROF VALUES(2,2)
INSERT INTO ALU_PROF VALUES(3,2)


--MATERIA -- ALUMNO
CREATE TABLE MAT_ALU(
CLAVE_M1 INT,
MAT_ALU2 INT,
CONSTRAINT FK_FM1 FOREIGN KEY (CLAVE_M1)REFERENCES MATERIA(CLAVE_M),
CONSTRAINT FK_FALU2 FOREIGN KEY(MAT_ALU2)REFERENCES ALUMNO(MAT_ALU)
)
INSERT INTO MAT_ALU VALUES(1,1)
INSERT INTO MAT_ALU VALUES(4,2)
INSERT INTO MAT_ALU VALUES(3,3)
INSERT INTO MAT_ALU VALUES(4,1)

--MATERIA -- PROFESOR
CREATE TABLE MAT_PROF(
CLAVE_M2 INT,
CLAVE_P2 INT,
CONSTRAINT FK_FM2 FOREIGN KEY(CLAVE_M2) REFERENCES MATERIA(CLAVE_M),
CONSTRAINT FK_FP2 FOREIGN KEY(CLAVE_P2)REFERENCES PROFESOR(CLAVE_P)
)
INSERT INTO MAT_PROF VALUES(2,1)

 SELECT NOM_ALU,EDAD_ALU,SEM_ALU,NOMB_C,NOM_P,NOM_M
 FROM ALUMNO INNER JOIN CARRERA ON ALUMNO.CLAVE_C1=CARRERA.CLAVE_C
 INNER JOIN ALU_PROF ON ALU_PROF.MAT_ALU1=ALUMNO.MAT_ALU
 INNER JOIN PROFESOR ON PROFESOR.CLAVE_P=ALU_PROF.CLAVE_P1
 INNER JOIN MAT_ALU ON MAT_ALU.MAT_ALU2=ALUMNO.MAT_ALU
 INNER JOIN MATERIA ON MATERIA.CLAVE_M=MAT_ALU.CLAVE_M1
 WHERE EDAD_ALU >18
 

 /*MODIFICAR UNA TABLA
 UPDATE"NOMBRE DE LA TABLA"
 SET CAMPO="NUEVO VALOR"
 FROM 
 WHERE
 */

